<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="wc.dao.ITbCrmPositionDao">
  <resultMap id="BaseResultMap" type="wc.entity.TbCrmPosition">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="ID" jdbcType="DECIMAL" property="id" />
    <result column="PARENT_ID" jdbcType="DECIMAL" property="parentId" />
    <result column="NAME" jdbcType="VARCHAR" property="name" />
    <result column="DEPARTMENT_ID" jdbcType="DECIMAL" property="departmentId" />
    <result column="DESCRIPTION" jdbcType="VARCHAR" property="description" />
  </resultMap>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from TB_CRM_POSITION
    where ID = #{id,jdbcType=DECIMAL}
  </delete>
  <insert id="insert" parameterType="wc.entity.TbCrmPosition">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into TB_CRM_POSITION (ID, PARENT_ID, NAME, 
      DEPARTMENT_ID, DESCRIPTION)
    values (TB_CRM_POSITION_id.nextval, #{parentId,jdbcType=DECIMAL}, #{name,jdbcType=VARCHAR}, 
      #{departmentId,jdbcType=DECIMAL}, #{description,jdbcType=VARCHAR})
  </insert>
  <update id="updateByPrimaryKey" parameterType="wc.entity.TbCrmPosition">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update TB_CRM_POSITION
    set PARENT_ID = #{parentId,jdbcType=DECIMAL},
      NAME = #{name,jdbcType=VARCHAR},
      DEPARTMENT_ID = #{departmentId,jdbcType=DECIMAL},
      DESCRIPTION = #{description,jdbcType=VARCHAR}
    where ID = #{id,jdbcType=DECIMAL}
  </update>
  <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select ID, PARENT_ID, NAME, DEPARTMENT_ID, DESCRIPTION
    from TB_CRM_POSITION
    where ID = #{id,jdbcType=DECIMAL}
  </select>
  <select id="selectAll" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select ID, PARENT_ID, NAME, DEPARTMENT_ID, DESCRIPTION
    from TB_CRM_POSITION
  </select>
  <!-- 初始化分页查询 -->
  <select id="findByPage" resultType="wc.entity.PositionVO">
  	select * from 
    (select tcp.*,rownum rn from 
    (select p.id as id,p.name as pname,p2.name as p2name,d.name as dname,p.description
  	from TB_CRM_POSITION p,tb_crm_department d,TB_CRM_POSITION p2 
  	where d.id=p.department_id and p.parent_id = p2.id ) tcp
    where rownum &lt; #{endNo})
    where rn &gt; #{startNo}
  </select>
  <!-- 初始化分页查询 -->
   <select id="findtotal" resultType="int">
  	select count(*)
  	from TB_CRM_POSITION p,tb_crm_department d,TB_CRM_POSITION p2 
  	where d.id=p.department_id and p.parent_id = p2.id 
  </select>
  <!-- 模糊分页查询 -->
  <select id="findByNamePage" resultType="wc.entity.PositionVO">
  	select * from 
    (select tcp.*,rownum rn from 
    (select p.id as id,p.name as pname,p2.name as p2name,d.name as dname,p.description
  	from TB_CRM_POSITION p,tb_crm_department d,TB_CRM_POSITION p2 
  	where d.id=p.department_id and p.parent_id = p2.id 
  	and p.name like '%' || #{name} || '%'
  	) tcp
    where rownum &lt; #{endNo})
    where rn &gt; #{startNo}
  </select>
   <!-- 模糊分页查询 -->
   <select id="findByNameTotal" resultType="int">
  	select count(*)
  	from TB_CRM_POSITION p,tb_crm_department d,TB_CRM_POSITION p2 
  	where d.id=p.department_id and p.parent_id = p2.id 
  	and p.name like '%' || #{name} || '%'
  </select>
</mapper>